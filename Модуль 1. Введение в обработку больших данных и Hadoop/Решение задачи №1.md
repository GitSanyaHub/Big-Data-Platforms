## 0. Подключаемся к виртуальной машине

```
 ssh team@176.109.91.8
 ```

- После этого будем находиться в team@team-6-jn

## 1. Настройка jn
### 1.1 Настройка пользователя
- Создаем специального пользователя *hadoop* (указать надежный пароль, остальные поля оставить пустыми)

```
team@team-6-jn:~$ sudo adduser hadoop
 ```
- Авторизуемся через этого пользователя

```
team@team-6-jn:~$ sudo -i -u hadoop
```

- Сгенерируем ssh ключ (на вопросы в процессе генерации прожать Enter)
```
hadoop@team-6-jn:~$ ssh-keygen
```

- Сохраним открытый ключ у себя (пока его можно скопировать в отдельный файл на своей локальной машине)
```
hadoop@team-6-jn:~$ cat .ssh/id_ed25519.pub
```
### 1.2 Скачивание Hadoop

- Скачаем Hadoop (это займет пару минут)
```
hadoop@team-6-jn:~$ wget https://dlcdn.apache.org/hadoop/common/hadoop-3.4.0/hadoop-3.4.0.tar.gz
```

### 1.3 Настроим адресацию, чтобы хосты знали друг друга по именам

- Выйдем из пользователя 
```
hadoop@team-6-jn:~$ exit
```

- Откроем файл для редактирования
```
team@team-6-jn:~$ sudo vim /etc/hosts
```
- Комментриуем ВСЕ текущие записи и делаем вставку с нашим адресами, сохраняем изменения
```
192.168.1.26 team-6-jn
192.168.1.27 team-6-nn
192.168.1.28 team-6-dn-00
192.168.1.29 team-6-dn-01
```
- Сделаем проверку после настройки для каждого адреса. При выполнении команд не должно возникать ошибок.

```
ping team-6-jn
```
```
ping team-6-nn
```
```
ping team-6-dn-00
```
```
ping team-6-dn-01
```

## 2. Настройка nn

- Из *jn* переключаемся на *nn*
```
team@team-6-jn:~$ ssh team-6-nn
```
- После выполнения команды будем находиться в  team@team-6-nn

### 2.1 Настроим адресацию, чтобы хосты знали друг друга по именам

- Откроем файл для редактирования
```
team@team-6-nn:~$ sudo vim /etc/hosts
```
- Комментриуем ВСЕ текущие записи и делаем вставку с нашим адресами, сохраняем изменения
```
192.168.1.26 team-6-jn
192.168.1.27 team-6-nn
192.168.1.28 team-6-dn-00
192.168.1.29 team-6-dn-01
```
- Сделаем проверку после настройки для каждого адреса. При выполнении команд не должно возникать ошибок.

```
ping team-6-jn
```
```
ping team-6-nn
```
```
ping team-6-dn-00
```
```
ping team-6-dn-01
```

### 2.2 Настройка пользователя
- Создаем специального пользователя *hadoop* (указать надежный пароль, остальные поля оставить пустыми)

```
team@team-6-nn:~$ sudo adduser hadoop
 ```
- Авторизуемся через этого пользователя

```
team@team-6-nn:~$ sudo -i -u hadoop
```

- Сгенерируем ssh ключ (на вопросы в процессе генерации прожать Enter)
```
hadoop@team-6-nn:~$ ssh-keygen
```

- Сохраним открытый ключ у себя (пока его можно скопировать в отдельный файл на своей локальной машине)
```
hadoop@team-6-nn:~$ cat .ssh/id_ed25519.pub
```
- Выходим из пользователя
```
hadoop@team-6-nn:~$ exit
```
- Переходим с *nn* на *jn*

```
team@team-6-nn:~$ exit
```

[//]: # (##########################################)

## 3. Настройка dn-00

- Из *jn* переключаемся на *dn-00*
```
team@team-6-jn:~$ ssh team-6-dn-00
```
- После выполнения команды будем находиться в   team-6-dn-00

### 3.1 Настроим адресацию, чтобы хосты знали друг друга по именам

- Откроем файл для редактирования
```
team@team-6-dn-00:~$ sudo vim /etc/hosts
```
- Комментриуем ВСЕ текущие записи и делаем вставку с нашим адресами, сохраняем изменения
```
192.168.1.26 team-6-jn
192.168.1.27 team-6-nn
192.168.1.28 team-6-dn-00
192.168.1.29 team-6-dn-01
```
- Сделаем проверку после настройки для каждого адреса. При выполнении команд не должно возникать ошибок.

```
ping team-6-jn
```
```
ping team-6-nn
```
```
ping team-6-dn-00
```
```
ping team-6-dn-01
```

### 3.2 Настройка пользователя
- Создаем специального пользователя *hadoop* (указать надежный пароль, остальные поля оставить пустыми)

```
team@team-6-dn-00:~$ sudo adduser hadoop
 ```
- Авторизуемся через этого пользователя

```
team@team-6-dn-00:~$ sudo -i -u hadoop
```

- Сгенерируем ssh ключ (на вопросы в процессе генерации прожать Enter)
```
hadoop@team-6-dn-00:~$ ssh-keygen
```

- Сохраним открытый ключ у себя (пока его можно скопировать в отдельный файл на своей локальной машине)
```
hadoop@team-6-dn-00:~$ cat .ssh/id_ed25519.pub
```
- Выходим из пользователя
```
hadoop@team-6-dn-00:~$ exit
```
- Переходим с *dn-00* на *jn*

```
team@team-6-dn-00:~$ exit
```

[//]: # (######################################)

## 4. Настройка dn-01

- Из *jn* переключаемся на *dn-01*
```
team@team-6-jn:~$ ssh team-6-dn-01
```
- После выполнения команды будем находиться в team-6-dn-01

### 4.1 Настроим адресацию, чтобы хосты знали друг друга по именам

- Откроем файл для редактирования
```
team@team-6-dn-01:~$ sudo vim /etc/hosts
```
- Комментриуем ВСЕ текущие записи и делаем вставку с нашим адресами, сохраняем изменения
```
192.168.1.26 team-6-jn
192.168.1.27 team-6-nn
192.168.1.28 team-6-dn-00
192.168.1.29 team-6-dn-01
```
- Сделаем проверку после настройки для каждого адреса. При выполнении команд не должно возникать ошибок.

```
ping team-6-jn
```
```
ping team-6-nn
```
```
ping team-6-dn-00
```
```
ping team-6-dn-01
```

### 4.2 Настройка пользователя
- Создаем специального пользователя *hadoop* (указать надежный пароль, остальные поля оставить пустыми)

```
team@team-6-dn-01:~$ sudo adduser hadoop
```
- Авторизуемся через этого пользователя

```
team@team-6-dn-01:~$ sudo -i -u hadoop
```

- Сгенерируем ssh ключ (на вопросы в процессе генерации прожать Enter)
```
hadoop@team-6-dn-01:~$  ssh-keygen
```

- Сохраним открытый ключ у себя (пока его можно скопировать в отдельный файл на своей локальной машине)
```
hadoop@team-6-dn-01:~$ cat .ssh/id_ed25519.pub
```
- Выходим из пользователя
```
hadoop@team-6-dn-01:~$ exit
```
- Переходим с *dn-01* на *jn*

```
team@team-6-dn-01:~$ exit
```

## 5. Связь пользователей по ssh

- Перейдем в пользователя *hadoop* на *jn*

```
team@team-6-jn:~$ sudo -i -u hadoop
```

- Создадим файл, где будут лежать ssh ключи для авторизации и вставим туда все публичные ключи, которые быди получены на предыдущих шагах
```
hadoop@team-6-jn:~$  vim .ssh/authorized_keys
```
- Создаем копию этого файла на всех нодах

```
hadoop@team-6-jn:~$ scp .ssh/authorized_keys team-6-nn:/home/hadoop/.ssh/
```
```
hadoop@team-6-jn:~$ scp .ssh/authorized_keys team-6-dn-00:/home/hadoop/.ssh/
```
```
hadoop@team-6-jn:~$ scp .ssh/authorized_keys team-6-dn-01:/home/hadoop/.ssh/
```

- Теперь можем переходить на другой адрес из-под пользователя *hadoop*, используя команду *ssh team-6-YourNode*


## 6. Распространение Hadoop на другие ноды

### 6.1 Файл, который был скачан в пункте 1.2, копируем на другие ноды

```
hadoop@team-6-jn:~$ scp hadoop-3.4.0.tar.gz  team-6-nn:/home/hadoop
```
```
hadoop@team-6-jn:~$ scp hadoop-3.4.0.tar.gz  team-6-dn-00:/home/hadoop
```
```
hadoop@team-6-jn:~$ scp hadoop-3.4.0.tar.gz  team-6-dn-01:/home/hadoop
```

### 6.2 Распаковывваем архивы на нодах

- Переходим с *jn* на *nn*, распаковываем, возвращаемся обратно
```
hadoop@team-6-jn:~$ ssh team-6-nn
```
```
hadoop@team-6-nn:~$ tar -xvzf hadoop-3.4.0.tar.gz
```
```
hadoop@team-6-nn:~$ exit
```

- Переходим с *jn* на *dn-00*, распаковываем, возвращаемся обратно
```
hadoop@team-6-jn:~$ ssh team-6-dn-00
```
```
hadoop@team-6-dn-00:~$ tar -xvzf hadoop-3.4.0.tar.gz
```
```
hadoop@team-6-dn-00:~$ exit
```

- Переходим с *jn* на *dn-01*, распаковываем, возвращаемся обратно
```
hadoop@team-6-jn:~$ ssh team-6-dn-01
```
```
hadoop@team-6-dn-01:~$ tar -xvzf hadoop-3.4.0.tar.gz
```
```
hadoop@team-6-dn-01:~$ exit
```

## Вывод

В результате работы была создана учётная запись, от имени которой будет происходить взаимодействие с Hadoop, и была обеспечена связь между узлами кластера, используя SSH-ключи и специальные имена хостов.